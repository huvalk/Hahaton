FROM ubuntu:18.04

USER root

COPY ../cmd /home/cmd

WORKDIR /home/cmd

RUN sed -i -E 's|^deb ([^ ]+) (.*)$|deb [arch=amd64] \1 \2\ndeb [arch=armhf] http://ports.ubuntu.com/ubuntu-ports/ \2|' /etc/apt/sources.list

RUN apt-get update && \
    apt install -y software-properties-common && \
    add-apt-repository "deb http://security.ubuntu.com/ubuntu xenial-security main" && \
    apt -y update && apt-get -y upgrade && apt-get -y dist-upgrade && apt-get -y autoremove && \
    apt install -y wget zip unzip gcc g++ build-essential cmake

RUN DEBIAN_FRONTEND="noninteractive" ./build_opencv.sh

